
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Release notes &#8212; re2c 2.1.1 documentation</title>
    <link rel="stylesheet" href="../_static/theme-re2c.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="alternate" type="application/atom+xml" href="../feed/atom.xml" title="Atom 1.0" />
    
 
  </head><body>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="re2c-logo">
    re2c
</div>

<h3><a href="../index.html">Home</a></h3>
<div class="re2c-toc-global">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../manual/manual_c.html">User manual (C)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/manual_go.html">User manual (Go)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Build instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks/benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog/changelog.html">Changelog</a></li>
</ul>

</div>
    <h3>Release notes</h3>
    <div class="re2c-toc-local">
        <ul>
<li><a class="reference internal" href="#">Release notes</a><ul>
<li><a class="reference internal" href="#release-2-1-1">Release 2.1.1</a></li>
<li><a class="reference internal" href="#release-2-1">Release 2.1</a></li>
<li><a class="reference internal" href="#release-2-0-3">Release 2.0.3</a></li>
<li><a class="reference internal" href="#release-2-0-2">Release 2.0.2</a></li>
<li><a class="reference internal" href="#release-2-0-1">Release 2.0.1</a></li>
<li><a class="reference internal" href="#release-2-0">Release 2.0</a></li>
<li><a class="reference internal" href="#release-1-3">Release 1.3</a></li>
<li><a class="reference internal" href="#release-1-2-1">Release 1.2.1</a></li>
<li><a class="reference internal" href="#release-1-2">Release 1.2</a></li>
<li><a class="reference internal" href="#release-1-1-1">Release 1.1.1</a></li>
<li><a class="reference internal" href="#release-1-1">Release 1.1</a></li>
<li><a class="reference internal" href="#release-1-0-3">Release 1.0.3</a></li>
<li><a class="reference internal" href="#release-1-0-2">Release 1.0.2</a></li>
<li><a class="reference internal" href="#release-1-0-1">Release 1.0.1</a></li>
<li><a class="reference internal" href="#id3">Release 1.0</a></li>
<li><a class="reference internal" href="#release-0-16">Release 0.16</a></li>
<li><a class="reference internal" href="#release-0-15-3">Release 0.15.3</a></li>
<li><a class="reference internal" href="#release-0-15-2">Release 0.15.2</a></li>
<li><a class="reference internal" href="#release-0-15-1">Release 0.15.1</a></li>
<li><a class="reference internal" href="#release-0-15">Release 0.15</a></li>
</ul>
</li>
</ul>

    </div>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="release-notes">
<h1>Release notes<a class="headerlink" href="#release-notes" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="release-2-1-1">
<h2>Release 2.1.1<a class="headerlink" href="#release-2-1-1" title="Permalink to this headline">¶</a></h2>
<p>This is a minor release that adds a missing file to the release tarballs
(thanks to <a class="reference external" href="https://github.com/david-geiger">david_david</a> for the bug report).
See the changelog <a class="reference internal" href="changelog/changelog.html#id1"><span class="std std-ref">2.1.1 (2021-03-27)</span></a> for details.</p>
</div>
<div class="section" id="release-2-1">
<h2>Release 2.1<a class="headerlink" href="#release-2-1" title="Permalink to this headline">¶</a></h2>
<p>This release adds continuous integration with GitHub Actions, portability
improvements, benchmarks, depfile generation and bugfixes.</p>
<p><strong>GitHub Actions CI.</strong>
<a class="reference external" href="https://github.com/sergeyklay">Serghei Iakovlev</a> has added continuous
integration with GitHub Actions for Linux, macOS and Windows platforms.
Now every change in re2c gets build and tested in various configurations on all
three platforms, which (hopefully!) leads to fewer bugs and better support for
these platforms. GitHub Actions complement the existing Travis CI.</p>
<p><strong>Benchmarks.</strong>
A lot of work has been done on adding infrastructure for benchmarks. Previously
re2c had some benchmarks, but they were not integrated into the build system,
and as a result somewhat difficult to build and run. Now there is a new
benchmark subsystem, which includes three groups.
The first group contains AOT-compiled benchmarks (a.k.a. lexer generators):
regular expressions that are compiled ahead of time to C code, which is further
compiled to native code. The currently supported generators are re2c, ragel and
kleenex.
The second group contains JIT-compiled benchmarks: library algorithms that are
based on deterministic automata.
Finally, the third group contains interpreted benchmarks: library algorithms
that are based on non-deterministic automata.
Benchmarks are fully integrated in both build systems (they are enabled with
Autotools options <code class="docutils literal notranslate"><span class="pre">--enable-benchmarks</span></code>, <code class="docutils literal notranslate"><span class="pre">--enable-benchmarks-regenerate</span></code>
and CMake options <code class="docutils literal notranslate"><span class="pre">-DRE2C_BUILD_BENCHMARKS</span></code>, <code class="docutils literal notranslate"><span class="pre">-DRE2C_REGEN_BENCHMARKS</span></code>).
All benchmarks are regularly built and ran on CI.
There is also a <a class="reference external" href="https://github.com/skvadrik/re2c/blob/master/benchmarks/json2pgfplot.py">script</a>
for rendering benchmark results as bar charts.</p>
<p>For lexer generators, benchmark results show that re2c-TDFA(1) and ragel are the
fastest algorithms. Their performance is very close, but in non-deterministic
cases ragel gives incorrect results due to its inability to remember multiple
parallel versions of one tag. On the other hand, kleenex programs are much
shorter and easier to read.</p>
<p><strong>Dependency files.</strong>
This release adds a <code class="docutils literal notranslate"><span class="pre">--depfile</span></code> option that allows one to generate dependency
(.d) files. This is needed in order to track build dependencies in the presence
of <code class="docutils literal notranslate"><span class="pre">/*!include:re2c*/</span></code> directives. The generated depfiles have the same format
as the ones generated with GCC <code class="docutils literal notranslate"><span class="pre">-MF</span></code> option.</p>
<p>There are also a few other improvements and bugfixes, see the full changelog
<a class="reference internal" href="changelog/changelog.html#id3"><span class="std std-ref">2.1 (2021-03-26)</span></a> for details.</p>
<p>A big warm thank you to all the people who contributed to this release!</p>
</div>
<div class="section" id="release-2-0-3">
<h2>Release 2.0.3<a class="headerlink" href="#release-2-0-3" title="Permalink to this headline">¶</a></h2>
<p>This is a minor bugfix release.
It fixes an issue when building re2c as a subproject of another CMake project
(thanks to <a class="reference external" href="https://github.com/hanak">Ivo Hanak</a> for the bugreport).
See the changelog <a class="reference internal" href="changelog/changelog.html#id7"><span class="std std-ref">2.0.3 (2020-08-22)</span></a> for details.</p>
</div>
<div class="section" id="release-2-0-2">
<h2>Release 2.0.2<a class="headerlink" href="#release-2-0-2" title="Permalink to this headline">¶</a></h2>
<p>This is a minor bugfix release.
It makes two changes.
First, re2go is now built by default (can be turned off with
<code class="docutils literal notranslate"><span class="pre">--disable-golang</span></code> for Autotools and <code class="docutils literal notranslate"><span class="pre">-DRE2C_BUILD_RE2GO=no</span></code> for CMake).
Second, CMake build files are now packaged into release tarball.
See the changelog <a class="reference internal" href="changelog/changelog.html#id9"><span class="std std-ref">2.0.2 (2020-08-08)</span></a> for details.</p>
</div>
<div class="section" id="release-2-0-1">
<h2>Release 2.0.1<a class="headerlink" href="#release-2-0-1" title="Permalink to this headline">¶</a></h2>
<p>This is a minor release that fixes re2c version (as output by <code class="docutils literal notranslate"><span class="pre">re2c</span> <span class="pre">-v</span></code>) for
the CMake build system. Thanks <a class="reference external" href="https://github.com/marryjianjian">marryjianjian</a>
for the bug report!
See the changelog <a class="reference internal" href="changelog/changelog.html#id10"><span class="std std-ref">2.0.1 (2020-07-29)</span></a> for details.</p>
</div>
<div class="section" id="release-2-0">
<h2>Release 2.0<a class="headerlink" href="#release-2-0" title="Permalink to this headline">¶</a></h2>
<p>This release adds a Go code generation backend,
an alternative CMake build system,
free-form generic API,
improvements in reuse mode and start conditions,
and bugfixes in EOF rule implementation.</p>
<p><strong>Go backend.</strong>
The new Go code generation backend can be used either with a <code class="docutils literal notranslate"><span class="pre">--lang</span> <span class="pre">go</span></code> re2c
option, or as a standalone re2go binary (which is identical to re2c with
<code class="docutils literal notranslate"><span class="pre">--lang</span> <span class="pre">go</span></code> set by default).
The documentation has been split into separate manpages for
<a class="reference internal" href="../manual/manual_c.html#user-manual-re2c"><span class="std std-ref">re2c</span></a> and
<a class="reference internal" href="../manual/manual_go.html#user-manual-re2go"><span class="std std-ref">re2go</span></a>; they are
generated from the same text, but have language-specific examples.
The re2go binary and manpage need to be enabled explicitly with a configuration
parameter <code class="docutils literal notranslate"><span class="pre">--enable-golang</span></code> for Autotools or <code class="docutils literal notranslate"><span class="pre">-DRE2C_BUILD_RE2GO=yes</span></code> for
CMake.
Unlike C, Go does not have pointer arithmetics, therefore re2go programs use
integer indices instead of pointers and have
<a class="reference internal" href="../manual/manual_go.html#program-interface"><span class="std std-ref">generic API</span></a> enabled by default.
Almost all re2c features have been ported to re2go, with the exception of code
generation options like <code class="docutils literal notranslate"><span class="pre">--computed-gotos</span></code> and <code class="docutils literal notranslate"><span class="pre">--case-ranges</span></code> that
need unsupported language features.
Behind the scenes adding a new backend required a
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/14c5bea6582f417e1cf60d5cb26823567435957c">full rewrite</a>
of the code generation subsystem and quite a bit of work on documentation
and testing.
Thanks to <a class="reference external" href="https://github.com/meme">meme</a> for
<a class="reference external" href="https://github.com/skvadrik/re2c/issues/272">discussing</a> the idea and
providing an early implementation prototype.
Feedback from the Go community is welcome!</p>
<p><strong>CMake build system.</strong>
Thanks to <a class="reference external" href="https://github.com/ligfx">ligfx</a> for
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/a530570e5164ae302f89b79f9e6b04032c697245">adding</a>
a CMake-based build system. This has been discussed multiple times in the past,
and a few <a class="reference external" href="https://github.com/skvadrik/re2c/issues/244">attempts</a> at an
implementation have been made, but ligfx was the first to contribute a full
working implementation.
The existing Autotools-based build system continues to be used and maintained
for the foreseeable future. In fact, both build systems are continuously tested
on Travis CI.
See the <a class="reference internal" href="../install/install.html#build-instructions"><span class="std std-ref">build instructions</span></a> page for
more details.</p>
<p><strong>Free-form generic API.</strong>
Generic API now supports
<a class="reference internal" href="../manual/manual_go.html#program-interface"><span class="std std-ref">two styles</span></a>: function-like style is
enabled with <code class="docutils literal notranslate"><span class="pre">re2c:api:style</span> <span class="pre">=</span> <span class="pre">functions;</span></code>, and free-form style is enabled
with <code class="docutils literal notranslate"><span class="pre">re2c:api:style</span> <span class="pre">=</span> <span class="pre">free-form;</span></code>.
Previously only the function-like style was supported, and free-form style
could be enabled for a few selected APIs with configurations like
<code class="docutils literal notranslate"><span class="pre">re2c:define:YYFILL:naked</span></code>, etc.
Free-form style allows to define API primitives as arbitrary strings of code
with interpolated arguments of the form <code class="docutils literal notranslate"><span class="pre">&#64;&#64;{name}</span></code>, or optionally just <code class="docutils literal notranslate"><span class="pre">&#64;&#64;</span></code>
if there is a single argument. The <code class="docutils literal notranslate"><span class="pre">&#64;&#64;</span></code> marker can be redefined with
<code class="docutils literal notranslate"><span class="pre">re2c:api:sigil</span></code> configuration.</p>
<p><strong>Improved reuse mode and start conditions.</strong>
The restriction on not using normal (non-conditional) blocks with
<code class="docutils literal notranslate"><span class="pre">-c,</span> <span class="pre">--start-conditions</span></code> option has been removed: now it is possible to have
both conditional and normal blocks. The switch on conditions is now generated
for every block rather than once per file, which allows to have multiple lexers
in one file.
The combination of <code class="docutils literal notranslate"><span class="pre">-r,</span> <span class="pre">--reuse</span></code> option with <code class="docutils literal notranslate"><span class="pre">-c,</span> <span class="pre">--start-conditions</span></code> and/or
<code class="docutils literal notranslate"><span class="pre">-f,</span> <span class="pre">--storable-state</span></code> options
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/217158707e2bc52d27956470bf1291df63be5530">now uses correct</a>
block-local options instead of global options in condition and state switch,
and re2c now generates
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/8f8d71e3104e52ab87940d322492d34bffff2c7a">unique labels</a>
in each reuse block.</p>
<p><strong>Fixes in EOF rule.</strong>
A bug that caused
<a class="reference external" href="https://github.com/skvadrik/re2c/issues/284">missing fallback states</a>
with EOF rule
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/9bb515e7374e4e96499d562f5e0207f02500fcd2">has been fixed</a>.
Re2c no longer generates
<a class="reference external" href="https://github.com/skvadrik/re2c/issues/280">overlapping labels</a>
when EOF rule is used with multiple blocks.</p>
<p><strong>Developer changes.</strong>
The way re2c bootstraps itself
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/967540566b8677c81f60ae6f14287b9e117125a4">has been simplified</a>:
instead of always trying to regenerate lexer files if the re2c binary exists in
the build directory, re2c now does this only when configured explicitly with
<code class="docutils literal notranslate"><span class="pre">--enable-lexers</span></code> for Autotools or <code class="docutils literal notranslate"><span class="pre">-DRE2C_REBUILD_LEXERS=yes</span></code> for CMake.
This configuration requires passing an explicit <code class="docutils literal notranslate"><span class="pre">RE2C_FOR_BUILD</span></code> variable that
contains a path to the re2c executable that will be used to regenerate lexers.
The new bootstrapping scheme allows to avoid build problems caused by
dynamically changing dependency graph, as well as hard-to-recover errors when a
bad re2c build was used to rebuild itself in a vicious loop.
Another developer-visible change is a
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/303ef4783707fd7616dd0cd984217c881e9dbb39">rework of the testing framework</a>,
which now uses in-line comments instead of hard-coding options in test filenames.</p>
<p><strong>Backwards incompatible changes.</strong>
In a few rare/undocumented cases re2c behavior has been changed in a way that
may break existing code:</p>
<ul class="simple">
<li><p>Generic APIs <code class="docutils literal notranslate"><span class="pre">YYSHIFT</span></code>/<code class="docutils literal notranslate"><span class="pre">YYSHIFTSTAG</span></code>/<code class="docutils literal notranslate"><span class="pre">YYSHIFTMTAG</span></code>
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/92cbf8fb76133dde062962ecf2856e143714b715">have been added</a>.
Their meaning is to shift the cursor/tag position by a specified offset.
The new APIs enable fixed-tags optimization with generic API, which is
becoming more important as the generic API is getting used more often.
Programs that use both generic API and tags or POSIX capturing groups may need
to define the new APIs.</p></li>
<li><p>Generic APIs <code class="docutils literal notranslate"><span class="pre">YYSTAGPD</span></code>/<code class="docutils literal notranslate"><span class="pre">YYMTAGPD</span></code> have been removed. They were used only
with the recently added experimental <code class="docutils literal notranslate"><span class="pre">--stadfa</span></code> option, and the removal is
unlikely to break any existing code.</p></li>
<li><p>In reuse mode configurations like <code class="docutils literal notranslate"><span class="pre">re2c:define:YYCTYPE</span></code> are
<a class="reference external" href="https://github.com/skvadrik/re2c/issues/291">no longer reset</a>
in each use block. The old behavior was kept only for backwards compatibility.
It has caused confusion and inconvenience, as the configurations had to be
repeatedly defined in each use block.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">re2c:flags:type-header</span></code> option now treats the header filename as
<a class="reference external" href="https://github.com/skvadrik/re2c/commit/dc0df494c6ec528094cf59cd17768e08e9af0e6a">relative to the output</a>
directory. The undocumented <code class="docutils literal notranslate"><span class="pre">re2c:flags:output</span></code> option has been removed.</p></li>
<li><p>Some internal labels have been renamed, in particular the <code class="docutils literal notranslate"><span class="pre">yyFillLabel</span></code>
prefix has been replaced with <code class="docutils literal notranslate"><span class="pre">yyfill</span></code>. This should not break any well-formed
code, as these labels are not part of the user interface. Programs that relied
on the old label names may restore them with the <code class="docutils literal notranslate"><span class="pre">re2c:label:yyFillLabel</span></code>
configuration.</p></li>
</ul>
<p>As always, a warm thank you to all the people who contributed to this release,
including
<a class="reference external" href="https://github.com/ligfx">ligfx</a>,
<a class="reference external" href="https://github.com/meme">meme</a>,
<a class="reference external" href="https://github.com/ryandesign">ryandesign</a>,
<a class="reference external" href="https://github.com/fanf2">fanf2</a>,
<a class="reference external" href="https://github.com/samebchase">samebchase</a>
and <a class="reference external" href="https://github.com/trofi">trofi</a>. :)</p>
<p>See the changelog <a class="reference internal" href="changelog/changelog.html#id11"><span class="std std-ref">2.0 (2020-07-20)</span></a> for details.</p>
</div>
<div class="section" id="release-1-3">
<h2>Release 1.3<a class="headerlink" href="#release-1-3" title="Permalink to this headline">¶</a></h2>
<p>The bulk of the work in this release was concentrated on implementing an
experimental submatch extraction algorithm. The new algorithm is based on
staDFA: another type of automaton described in the paper <em>“staDFA: An Efficient
Subexpression Matching Method”</em> by Mohammad Imran Chowdhury (2018).
Like TDFA, staDFA performs operations on variables that hold submatch positions
during the matching process. The main difference between the two automata types
is that TDFA associates variable operations with
transitions, while staDFA puts them in states. Now that we have an experimental
implementation of staDFA in re2c, it is possible to compare its performance
against TDFA. The initial experiments have shown that on average staDFA is
slower and larger than TDFA(1): it has more variable operations and more states.
It still remains to run proper benchmarks and formalize the modifications to
the original algorithm that we had to make for correctness and performance.
The new staDFA algorithm is enabled with <code class="docutils literal notranslate"><span class="pre">--stadfa</span></code> option.</p>
<p>This release adds a new warning <code class="docutils literal notranslate"><span class="pre">-Wsentinel-in-midrule</span></code> that warns the user in
the case when the sentinel symbol occurs in the middle of the rule – this may
cause reads past the end of buffer, crashes or memory corruption in the
generated lexer. Complimentary to the warning there is a new configuration
<code class="docutils literal notranslate"><span class="pre">re2c:sentinel</span></code> that allows to specify which symbol is used as a sentinel
(by default re2c assumes <code class="docutils literal notranslate"><span class="pre">NULL</span></code>). It this configuration is used, then
<code class="docutils literal notranslate"><span class="pre">-Wsentinel-in-midrule</span></code> is an error.</p>
<p>Some work has been done on reproducible builds.</p>
<p>As usual, thanks to all the people who contributed to this release (including
Chris Lamb, jcfp and Ondřej Čertík)!
See the changelog <a class="reference internal" href="changelog/changelog.html#id25"><span class="std std-ref">1.3 (2019-12-14)</span></a> for
details.</p>
</div>
<div class="section" id="release-1-2-1">
<h2>Release 1.2.1<a class="headerlink" href="#release-1-2-1" title="Permalink to this headline">¶</a></h2>
<p>This is a minor release that improves some of the features introduced in 1.2.
First, it is now possible to reset <code class="docutils literal notranslate"><span class="pre">re2c:eof</span></code> configuration to the
default value by setting it to <code class="docutils literal notranslate"><span class="pre">-1</span></code>. Second, re2c now installs standard
include files to <code class="docutils literal notranslate"><span class="pre">$(datadir)/re2c/stdlib</span></code>, where <code class="docutils literal notranslate"><span class="pre">$(datadir)</span></code> is
<code class="docutils literal notranslate"><span class="pre">/usr/share</span></code> by default (but can be configured otherwise). When looking for
include files, re2c automatically tries this directory — there is no need
to add it manually with <code class="docutils literal notranslate"><span class="pre">-I</span></code>.
Both issues have been reported by Wesley W. Terpstra. Thank you!</p>
<p>See the changelog <a class="reference internal" href="changelog/changelog.html#id28"><span class="std std-ref">1.2.1 (2019-08-11)</span></a> for details.</p>
</div>
<div class="section" id="release-1-2">
<h2>Release 1.2<a class="headerlink" href="#release-1-2" title="Permalink to this headline">¶</a></h2>
<p>This release adds a handful of useful features and finalizes two-year
research effort on POSIX disambiguation.</p>
<p>First and foremost, <a class="reference internal" href="../manual/manual_c.html#sentinel-character-with-bounds-checks"><span class="std std-ref">end of input rule</span></a> has been added to
re2c. It is a new method of checking for the end of input, which aims at being
both generic and simple to use. Historically re2c has a
<a class="reference internal" href="../manual/manual_c.html#handling-the-end-of-input"><span class="std std-ref">number of ways</span></a> to handle EOF situation. The
simplest and the most efficient method is
<a class="reference internal" href="../manual/manual_c.html#sentinel-character"><span class="std std-ref">using a sentinel symbol</span></a>, but it
has limited applicability. The most widely used and generic method is
<a class="reference internal" href="../manual/manual_c.html#bounds-checks-with-padding"><span class="std std-ref">bounds checking with padding</span></a>,
but it is rather complex and requires input buffering.
Finally, it is possible to define custom EOF handling methods
by <a class="reference internal" href="../manual/manual_c.html#custom-methods-with-generic-api"><span class="std std-ref">using the generic API</span></a>. However, such
methods are not necessarily correct and are likely to be slower than other
methods. The new method, EOF rule, tries to combine the simplicity and
efficiency of the sentinel symbol and the generality of bounds checking.
Essentially, all the user is required to do is to specify an arbitrary “fake”
sentinel using <code class="docutils literal notranslate"><span class="pre">re2c:eof</span></code> configuration (zero is usually a good choice), to
define a special EOF rule <code class="docutils literal notranslate"><span class="pre">$</span></code>, and to make sure that the fake sentinel is
always the last symbol in the input buffer. The lexer will then run without end
of input checks until it hits the branch corresponding to the fake sentinel, at
which point it will perform additional bounds checking. If indeed it is the end,
the lexer will try to get more input. If this attempt fails, the lexer will
either rollback to the last matched rule (or the default rule, if it has
consumed some input but did not match), or else it will go to EOF rule.
Depending on each particular case and the choice of sentinel, the performance of
EOF rule may be slightly better or worse than bounds checking with padding.
See the user manual for more details and examples.</p>
<p>Another important new feature is the possibility to <a class="reference internal" href="../manual/manual_c.html#include-files"><span class="std std-ref">include other files</span></a>. Re2c provides a directive
<code class="docutils literal notranslate"><span class="pre">/*!include:re2c</span> <span class="pre">&quot;file.re&quot;</span> <span class="pre">*/</span></code>, where <code class="docutils literal notranslate"><span class="pre">file.re</span></code> is the name of the included
file.
Re2c looks for included files in the directory of the including file and in the
include locations, which can be specified with <code class="docutils literal notranslate"><span class="pre">-I</span></code> option. Include files
may have further includes of their own. Re2c provides some predefined include
files that can be found in the <code class="docutils literal notranslate"><span class="pre">include/</span></code> sub-directory of the project. These
files contain useful definitions and form something like a standard library
for re2c. Currently there is one available include, <code class="docutils literal notranslate"><span class="pre">unicode_categories.re</span></code>.</p>
<p>Re2c now allows to <a class="reference internal" href="../manual/manual_c.html#header-files"><span class="std std-ref">generate header file</span></a>
from the input file using option <code class="docutils literal notranslate"><span class="pre">-t</span> <span class="pre">--type-header</span></code> or
<code class="docutils literal notranslate"><span class="pre">re2c:flags:t</span></code> and <code class="docutils literal notranslate"><span class="pre">re2c:flags:type-header</span></code> configurations and the newly
added directives <code class="docutils literal notranslate"><span class="pre">/*!header:re2c:on*/</span></code> and <code class="docutils literal notranslate"><span class="pre">/*!header:re2c:off*/</span></code>.
Header files may be needed in cases when re2c is used to generate definitions
of constants, variables and structs that must be visible from other translation
units.</p>
<p>Re2c can now understand UTF8-encoded string literals and character classes in
regular expressions. By default, re2c parses regular expressions like
<code class="docutils literal notranslate"><span class="pre">&quot;∀x</span> <span class="pre">∃y&quot;</span></code> as a sequence of 1-byte ASCII code points
<code class="docutils literal notranslate"><span class="pre">e2</span> <span class="pre">88</span> <span class="pre">80</span> <span class="pre">78</span> <span class="pre">20</span> <span class="pre">e2</span> <span class="pre">88</span> <span class="pre">83</span> <span class="pre">79</span></code> (hexadecimal), and the users have to escape
Unicode symbols manually: <code class="docutils literal notranslate"><span class="pre">&quot;\u2200x</span> <span class="pre">\u2203y&quot;</span></code>. This is not what most users
would expect, as demonstrated by multiple issues on the bugtracker. The new
option <code class="docutils literal notranslate"><span class="pre">--input-encoding</span> <span class="pre">&lt;ascii</span> <span class="pre">|</span> <span class="pre">utf8&gt;</span></code> allows to change the default
behavior and parse <code class="docutils literal notranslate"><span class="pre">&quot;∀x</span> <span class="pre">∃y&quot;</span></code> as a sequence of 4-byte Unicode code points
<code class="docutils literal notranslate"><span class="pre">2200</span> <span class="pre">78</span> <span class="pre">20</span> <span class="pre">2203</span> <span class="pre">79</span></code> (hexadecimal). Note that the new option affects only
parsing, and not the code generation.</p>
<p>Re2c now allows to mix <a class="reference internal" href="../manual/manual_c.html#reusable-blocks"><span class="std std-ref">reusable blocks</span></a>
with normal blocks when <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">--reuse</span></code> option is used. This is very useful in
cases when the input file contains many re2c blocks, and only some of them need
to be reused (a good example is re2c own lexer, which has to use certain rules
twice in order to generate ASCII and UTF8 lexer variants for
<code class="docutils literal notranslate"><span class="pre">--input-encoding</span> <span class="pre">&lt;ascii</span> <span class="pre">|</span> <span class="pre">utf8&gt;</span></code> option).</p>
<p>It is now possible to specify location format in re2c-generated messages with
<code class="docutils literal notranslate"><span class="pre">--location-format</span> <span class="pre">&lt;gnu</span> <span class="pre">|</span> <span class="pre">msvc&gt;</span></code> option. As one might guess, possible
arguments are GNU location format <code class="docutils literal notranslate"><span class="pre">filename:line:column:</span></code> (the default) and
MSVC format <code class="docutils literal notranslate"><span class="pre">filename(line,column)</span></code>. This option might help IDE users.
Another new option is <code class="docutils literal notranslate"><span class="pre">--verbose</span></code> — it prints a short “success” message in
case re2c exits successfully.</p>
<p>Flex compatibility mode (enabled with <code class="docutils literal notranslate"><span class="pre">-F</span> <span class="pre">--flex-support</span></code> option) has been
improved: parsing errors and incorrect operator precedence in some rare cases
have been fixed. Historically re2c allows to mix flex-style code with re2c-style
code, which creates certain difficulties for the parser. Such difficulties can
be resolved by passing parts of the parser context to the lexer.</p>
<p>The difference operator <code class="docutils literal notranslate"><span class="pre">/</span></code> is now applied to its operands before encoding
expansion. Re2c supports difference only for character classes, and encoding
expansion in case of a variable-length encoding may transform even a simple
character class into a complex graph (see
<a class="reference external" href="../../_images/utf8_any.png">the graph</a> for <code class="docutils literal notranslate"><span class="pre">[^]</span></code> in UTF8 for example).
Applying expansion after difference makes <code class="docutils literal notranslate"><span class="pre">/</span></code> applicable in more cases.</p>
<p>Re2c now generates the output file atomically: it first creates a temporary file
and writes the generated output into it, and then renames the temporary file to
the output file.</p>
<p>Documentation has been rearranged and updated, and the website has been
fixed to look somewhat better on mobile devices (hopefully).</p>
<p>From developers standpoint, re2c now has better debugging capabilities. Debug
code has been moved in a separate subsystem and is no longer built in release
binaries (debug builds are enabled with <code class="docutils literal notranslate"><span class="pre">--enable-debug</span></code> configure option).
New debug options and passes have been added.</p>
<p>This release has taken almost a year, mostly because of the time needed to
formalize the extended algorithm for POSIX disambiguation and write a formal
paper <a class="reference external" href="../../2019_borsotti_trofimovich_efficient_posix_submatch_extraction_on_nfa.pdf">Efficient POSIX Submatch Extraction on NFA</a>.
The algorithms described in the paper are implemented in an experimental
library <code class="docutils literal notranslate"><span class="pre">libre2c</span></code>. The library is intended as a playground for experiments
and research, not a replacement for existing libraries like RE2. Having re2c
as a library is convenient for benchmarking, testing and creating bindings to
other languages.
To build the library and benchmarks, configure re2c with <code class="docutils literal notranslate"><span class="pre">--enable-libs</span></code> option.</p>
<p>Many people have contributed to this release.
Angelo Borsotti co-authored the paper; his hard work has revealed multiple
shortcomings and deficiencies in the algorithms used in re2c.
Henri Salo helped with fuzz-testing re2c using the American Fuzzy Lop.
Denis Naumov helped with Windows portability issues.
Sergei Trofimovich fixed a number of bugs;
he and Serghei Iakovlev helped with the Travis CI infrastructure.
Wesley Terpstra used re2c in the open-source
<a class="reference external" href="https://github.com/sifive/wake">wake build tool</a>.
Many thanks to them and all the others who contributed to this release!</p>
<p>A lot of bugs have been fixed.
See the changelog <a class="reference internal" href="changelog/changelog.html#id31"><span class="std std-ref">1.2 (2019-08-02)</span></a> for details.</p>
</div>
<div class="section" id="release-1-1-1">
<h2>Release 1.1.1<a class="headerlink" href="#release-1-1-1" title="Permalink to this headline">¶</a></h2>
<p>This is a minor bug-fix release.
It fixes a crash with <code class="docutils literal notranslate"><span class="pre">-V</span></code> <code class="docutils literal notranslate"><span class="pre">--vernum</span></code> option.
The crash was reported and fixed by Mike Gilbert,
and later rediscovered by Daniel J. Luke and Perry E. Metzger.
Sergei Trofimovich made a unit test, as the <code class="docutils literal notranslate"><span class="pre">-V</span></code> <code class="docutils literal notranslate"><span class="pre">--vernum</span></code> option has already caused some troubles in the past.
See the changelog <a class="reference internal" href="changelog/changelog.html#id81"><span class="std std-ref">1.1.1 (2018-08-30)</span></a> for details.
Thanks everyone!</p>
</div>
<div class="section" id="release-1-1">
<h2>Release 1.1<a class="headerlink" href="#release-1-1" title="Permalink to this headline">¶</a></h2>
<p>This release doesn’t bring in any serious user-visible changes;
most of the work concentrated on the internal POSIX disambiguation algorithm
used for submatch extraction with <code class="docutils literal notranslate"><span class="pre">--posix-captures</span></code> option.
The old algorithm, introduced in <a class="reference external" href="./1_0.html">release 1.0</a>, was based on the work of Chris Kuklewicz
(outlined on this <a class="reference external" href="https://wiki.haskell.org/index.php?title=Regular_expressions/Bounded_space_proposal&amp;oldid=11475">haskell wiki page</a>
and formalized in the paper <a class="reference external" href="http://re2c.org/2017_trofimovich_tagged_deterministic_finite_automata_with_lookahead.pdf">Tagged Deterministic Finite Automata with Lookahead</a>).
Kuklewicz algorithm was replaced with a totally different algorithm
based on the work of Satoshi Okui and Taro Suzuki (described in the paper
“Disambiguation in Regular Expression Matching via Position Automata with Augmented Transitions”, year 2013).
The main effort in this release was in developing proper theoretical foundations for the new algorithm.
As usual, there has been a couple of bug fixes.</p>
<p>See the changelog <a class="reference internal" href="changelog/changelog.html#id83"><span class="std std-ref">1.1 (2018-08-27)</span></a> for details.</p>
</div>
<div class="section" id="release-1-0-3">
<h2>Release 1.0.3<a class="headerlink" href="#release-1-0-3" title="Permalink to this headline">¶</a></h2>
<p>Yet another minor bug-fix release.
It fixes a build failure on Mac OS X (thanks to Ryan Shmidt for the bug report).
See the changelog <a class="reference internal" href="changelog/changelog.html#id86"><span class="std std-ref">1.0.3 (2017-11-08)</span></a> for details.</p>
</div>
<div class="section" id="release-1-0-2">
<h2>Release 1.0.2<a class="headerlink" href="#release-1-0-2" title="Permalink to this headline">¶</a></h2>
<p>This is another minor bug-fix release.
It addresses some documentation issues (thanks to Ziris85 for the bug report).
See the changelog <a class="reference internal" href="changelog/changelog.html#id88"><span class="std std-ref">1.0.2 (2017-08-26)</span></a> for details.</p>
</div>
<div class="section" id="release-1-0-1">
<h2>Release 1.0.1<a class="headerlink" href="#release-1-0-1" title="Permalink to this headline">¶</a></h2>
<p>This is a minor bug-fix release.
It fixes a build failure on Mac OS X (thanks to ilovezf for the bug report).
See the changelog <a class="reference internal" href="changelog/changelog.html#id90"><span class="std std-ref">1.0.1 (2017-08-11)</span></a> for details.</p>
</div>
<div class="section" id="id3">
<h2>Release 1.0<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>This release is an important milestone in the history of re2c: it adds <em>submatch extraction</em>.
It is a long-awaited feature; even as Peter Bumbulis released the first version of re2c back in 1993,
he mentioned submatch extraction in his paper together with Donald D. Cowan
<a class="reference external" href="../../1994_bumbulis_cowan_re2c_a_more_versatile_scanner_generator.ps">“RE2C: a more versatile scanner generator”</a>
as a useful feature that soon should be added to re2c.
It seemed back then that submatch extraction is relatively easy to implement;
like many other useful extensions, it was deemed to be no more than syntactic sugar on top of canonical regular expressions.</p>
<p>As it turned out, this is not so:
the problem of <em>parsing</em> with regular expressions is inherently more complex than <em>recognition</em>,
and submatch extraction cannot be implemented using traditional DFA-based approach.
Many authors studied this subject and developed algorithms suitable for their particular settings and problem domains.
Some of them used NFA-based approach,
others suggested algorithms based on multiple DFA or multiple passes over a single DFA.
For re2c most of these algorithms are too heavyweight:
they require complication of the underlying computational model and incur overhead even in simple cases.</p>
<p>However, one algorithm is outstanding in this respect:
it is the algorithm invented by Ville Laurikari in 2000 and described in his paper
<a class="reference external" href="http://laurikari.net/ville/spire2000-tnfa.pdf">“NFAs with Tagged Transitions, their Conversion to Deterministic Automata and Application to Regular Expressions”</a>.
Laurikari algorithm is based on a single DFA extended with a fixed number of <em>registers</em>; it makes one pass over the input string,
works in linear time and the required space does not depend on the input length.
But what is most important, the added complexity depends on submatch detalization:
on submatch-free regular expressions Laurikari automaton reduces to a simple DFA.</p>
<p>When the work on submatch extraction feature started in early 2016,
at first it seemed that Laurikari algorithm was still overly complicated.
Re2c needed an algorithm that would support only <em>partial</em> submatch extraction,
but the supported cases would be handled very efficiently.
A lot of effort was spent on studying papers,
and finally this lead to the development of a new algorithm.
It soon became clear that the self-invented algorithm was in fact a special case of Laurikari algorithm,
with one significant performance improvement: the use of lookahead symbol.
Surprisingly, the original Laurikari algorithm has a strange deficiency:
when recording submatches, the automata totally ignore the lookahead symbol
and perform a lot of redundant operations that could be easily avoided.
It was only logical to fix Laurikari algorithm.
The new improved algorithm is described in the paper
<a class="reference external" href="../../2017_trofimovich_tagged_deterministic_finite_automata_with_lookahead.pdf">“Tagged Deterministic Finite Automata with Lookahead”</a></p>
<p>Submatch extraction in re2c comes in two flavors:
POSIX-compliant capturing groups (with true POSIX semantics)
and standalone <em>tags</em> that use leftmost greedy disambiguation.
Both features require a number of new API primitives and configurations;
and they are barely documented yet (though I managed to add a section in the manual).
The paper cited above has some interesting benchmark results;
articles and examples will follow in the nearest future.
As usually, you may expect a number of small bug-fix releases in the 1.0.x series.</p>
<p>The following people contributed to this release:</p>
<ul class="simple">
<li><p>Petr Skocik tidied up re2c documentation: fixed ubiquitous spelling errors
and established synchronization system between the online documentation,
manpage and help message displayed by re2c with <code class="docutils literal notranslate"><span class="pre">--help</span></code> option.</p></li>
<li><p>Sergei Trofimovich wrote a <em>fuzzer</em> that generates random regular expressions
and checks them on input data generated with re2c <code class="docutils literal notranslate"><span class="pre">--skeleton</span></code> option.
This fuzzer is most helpful; it has already found tens of bugs in the early implementation of submatch extraction.
Sergei also helped me with testing re2c on numerous platforms and computer architectures.</p></li>
<li><p>Abs62,
asmwarrior,
Ben Smith,
CRCinAU,
Derick Rethans,
Dimitri John Ledkov,
Eldar Zakirov,
jcfp,
Jean-Claude Wippler,
Jeff Trull,
Jérôme Dumesnil,
Jesse Buesking,
Julian Andres Klode,
Paulo Custodio,
Perry E. Metzger,
philippschaefer,
Ross Burton,
Rui Maciel,
Ryan Mast,
Samuel006,
sirzooro,
Tim Kelly
— all these people contributed bug reports, patches and feedback. Thank you!</p></li>
<li><p>Many thanks to the early user of the new features João Paredes for his patience and encouraging comments on the subject.</p></li>
</ul>
<p>See the changelog <a class="reference internal" href="changelog/changelog.html#id92"><span class="std std-ref">1.0 (2017-08-11)</span></a> for details.</p>
</div>
<div class="section" id="release-0-16">
<h2>Release 0.16<a class="headerlink" href="#release-0-16" title="Permalink to this headline">¶</a></h2>
<p>This release adds a very important step in the process of code generation:
minimization of the underlying DFA (deterministic finite automaton).
Simply speaking, this means that re2c now generates less code
(while the generated code behaves exactly the same).</p>
<p>DFA minimization is a very well-known technique
and one might expect that any self-respecting lexer generator would definitely use it.
So how could it be that re2c didn’t?
In fact, re2c did use a couple of self-invented tricks to compress the generated code
(one interesting technique is the construction of a <em>tunnel</em> automaton).
Some of these tricks were quite buggy (see <a class="reference external" href="https://bugs.gentoo.org/show_bug.cgi?id=518904">this bug report</a> for example).
Now that re2c does canonical DFA minimization, all this stuff is obsolete and has been dropped.</p>
<p>A lot of attention has been paid to the correctness of the DFA minimization.
Usually, re2c uses a very simple criterion to validate changes:
the generated code for all the tests in testsuite must remain the same.
However, in the case of DFA minimization the generated code changes dramatically.
It is impossible to verify the changes manually.</p>
<p>One possible verification tool is the <a class="reference internal" href="../manual/manual_c.html#skeleton-programs"><span class="std std-ref">skeleton</span></a> feature.
Because skeleton is constructed prior to DFA minimization, it cannot be affected by any errors in its implementation.</p>
<p>Another way to verify DFA minimization is by implementing two different algorithms
and comparing the results. The minimization procedure has a very useful property:
the miminal DFA is unique (with respect to state relabeling).
We used the Moore and the so-called <em>table filling</em> algorithms:
The Moore algorithm is fast, while table filling is very simple to implement.
The <code class="docutils literal notranslate"><span class="pre">--dfa-minimization</span> <span class="pre">&lt;moore</span> <span class="pre">|</span> <span class="pre">table&gt;</span></code> option that allows choosing
the particular algorithm (defaults to <code class="docutils literal notranslate"><span class="pre">moore</span></code>), but it’s only useful for debugging
DFA minimization.</p>
<p>A good side effect of messing with re2c internals is a significant speedup
of code generation (see <a class="reference external" href="https://github.com/skvadrik/re2c/issues/128">this issue</a> for example).
The test suite now runs twice as fast (at least).</p>
<p>See the changelog <a class="reference internal" href="changelog/changelog.html#id123"><span class="std std-ref">0.16 (2016-01-21)</span></a> for details.</p>
</div>
<div class="section" id="release-0-15-3">
<h2>Release 0.15.3<a class="headerlink" href="#release-0-15-3" title="Permalink to this headline">¶</a></h2>
<p>This release fixes multiple build-time and run-time failures on OS X, FreeBSD, and Windows.
Most of the problems were reported and fixed by Oleksii Taran (on OS X)
and Sergei Trofimovich (on FreeBSD and Windows).
Thank you for your help!</p>
<p><a class="reference internal" href="../manual/manual_c.html#skeleton-programs"><span class="std std-ref">Skeleton</span></a> coverage has been improved.</p>
<p>See the changelog <a class="reference internal" href="changelog/changelog.html#id128"><span class="std std-ref">0.15.3 (2015-12-02)</span></a> for details.</p>
</div>
<div class="section" id="release-0-15-2">
<h2>Release 0.15.2<a class="headerlink" href="#release-0-15-2" title="Permalink to this headline">¶</a></h2>
<p>This release fixes a bug in the build system:
it adds a missing dependency of the lexer on the bison-generated header
(<a class="reference external" href="https://bugs.gentoo.org/show_bug.cgi?id=566620">reported</a> on Gentoo bugtracker).
See the changelog <a class="reference internal" href="changelog/changelog.html#id132"><span class="std std-ref">0.15.2 (2015-11-23)</span></a> for details.</p>
</div>
<div class="section" id="release-0-15-1">
<h2>Release 0.15.1<a class="headerlink" href="#release-0-15-1" title="Permalink to this headline">¶</a></h2>
<p>This release fixes an error in the testing script
(thanks to Sergei Trofimovich who reported the bug and suggested a quick fix).
See the changelog <a class="reference internal" href="changelog/changelog.html#id133"><span class="std std-ref">0.15.1 (2015-11-22)</span></a> for details.</p>
</div>
<div class="section" id="release-0-15">
<h2>Release 0.15<a class="headerlink" href="#release-0-15" title="Permalink to this headline">¶</a></h2>
<p>This release started out in the spring of 2015 as a relatively simple code cleanup.</p>
<p>It focused on the following problem: re2c used to repeat the whole generation process multiple times.
Some parts of the generated program depend on the overall input statistics;
they cannot be generated until the whole input has been processed.
The usual strategy is to make stubs for all such things and fix them later.
Instead, re2c used to process the whole input, gather statistics,
discard the generated output, and regenerate it from scratch.
Moreover, each generation pass further duplicated certain calculations (for similar reasons).
As a result, the code generation phase was repeated four times.</p>
<p>The problem here was not inefficiency: re2c is fast enough to allow the 4x overhead.
The real problem was the complexity of the code: the developer has to think of multiple execution layers all the time.
Some parts of code are only executed on certain layers and affect each other.
Simple reasoning gets really hard.</p>
<p>So the main purpose of this release was to simplify the code and make it easier to fix bugs and add new features.
Very soon it became clear that some of the changes in code generation are hard to verify by hand.
For example, even a minor rebalancing of <code class="docutils literal notranslate"><span class="pre">if</span></code> and <code class="docutils literal notranslate"><span class="pre">switch</span></code> statements
may change the generated code significantly.
It was clear that re2c needed an automatic verification tool,
which lead to the idea of generating <a class="reference internal" href="../manual/manual_c.html#skeleton-programs"><span class="std std-ref">skeleton programs</span></a>.</p>
<p>Meanwhile some work was done on adding warnings,
updating the build system and fixing various bugs.
A heart-warming consequence of the code simplification is that re2c now uses re2c more extensively:
not only the main program, but also the command-line options, inplace configurations,
and all kinds of escaped strings are parsed with re2c.
Website has also been updated (feel free to suggest improvements).</p>
<p>See the changelog <a class="reference internal" href="changelog/changelog.html#id134"><span class="std std-ref">0.15 (2015-11-22)</span></a> for details.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
      Last updated on May 21, 2021.
    </div>
  </body>
</html>